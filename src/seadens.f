      subroutine seadens(rlat,rlong,rho)
c
c     $Id: seadens.f,v 1.3 2013/03/11 02:03:16 agnew Exp agnew $
c
c     $Log: seadens.f,v $
c     Revision 1.3  2013/03/11 02:03:16  agnew
c     force local longitude variable to be 0 to 360
c
c     Revision 1.2  2011/12/27 21:26:51  agnew
c     Fixed Arctic Ocean cells
c
c     Revision 1.1  2011/11/19 19:10:20  agnew
c     Initial revision
c
c
c
c  Returns the surface density at given location
c
c    Values are dsnsities averaged over monthly values, computed from
c    T and S grids of statistical means in the 2009 World Ocean Atlas
c    (annual values of T and S used if no others available)
c
c  If no grid data, value is found by averaging over adjacent nonzero
c    cells. This means that nonzero values will be returned over many
c    land areas.
c
      common/dens/idens(72,36)
      data idens/
     1  -900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,
     2  -900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,
     3  -900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,
     4  -900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,
     5  -900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,
     6  -900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,
     7  -900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,
     8  -900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,
     9  -900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,
     1  -900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,
     2  -900,-900,-900,-900,-900,-900,-900,-900,-900,2730,-900,-900,
     3  -900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,
     4  -900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,
     5  -900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,
     6  -900,-900,-900,-900,-900,-900,-900,-900,2698,2721,2732,2732,
     7  2730,2732,2734,2706,2664,2677,2628,-900,-900,-900,-900,-900,
     8  -900,-900,-900,-900,-900,-900,-900,-900,-900,-900,2730,2730,
     9  2729,2726,2727,2694,2696,2727,2687,-900,-900,-900,-900,-900,
     1  2627,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,
     2  -900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,
     3  -900,-900,-900,-900,-900,-900,-900,-900,-900,2732,2732,2731,
     4  2712,2630,2633,2629,2626,2660,2628,2628,2627,2628,2650,2631,
     5  2659,2629,2630,2630,2634,2646,2659,2625,2623,2623,-900,2728,
     6  2730,2725,2725,2659,2624,2677,2680,2687,2701,2691,2685,2664,
     7  2723,2651,2673,2669,2666,2660,2666,2700,2659,2665,2679,2684,
     8  2650,2661,2664,2663,2636,2655,2662,2660,2677,2663,2697,2673,
     9  2636,2655,2633,2682,2697,2648,2672,2665,2657,2676,2685,2648,
     1  2699,2675,2693,2675,2633,2635,2660,2652,2655,2650,2643,2659,
     2  2659,2650,2661,2637,2634,2681,2641,2642,2648,2639,2640,2614,
     3  2699,2676,2684,2693,2688,2702,2682,2717,2719,2704,2711,2713,
     4  2724,2724,2710,2661,2672,2651,2667,2677,2662,2690,2680,2658,
     5  2636,2640,2640,2640,2655,2675,2665,2689,2663,2656,2692,2686,
     6  2696,2648,2641,2638,2655,2655,2665,2658,2674,2650,2651,2648,
     7  2657,2653,2666,2679,2683,2709,2744,2697,2707,2706,2664,2672,
     8  2691,2710,2684,2691,2706,2699,2675,2674,2690,2654,2642,2654,
     9  2729,2725,2707,2667,2700,2671,2656,2678,2669,2721,2702,2723,
     1  2727,2736,2698,2701,2682,2684,2684,2666,2678,2658,2651,2666,
     2  2643,2653,2642,2663,2689,2645,2653,2669,2670,2647,2647,2648,
     3  2650,2650,2651,2650,2649,2672,2659,2651,2668,2742,2742,2743,
     4  2736,2736,2703,2669,2677,2674,2727,2719,2701,2693,2744,2744,
     5  2736,2743,2752,2760,2760,2752,2758,2759,2759,2741,2701,2686,
     6  2690,2648,2694,2701,2676,2674,2686,2639,2648,2637,2679,2696,
     7  2646,2664,2687,2720,2729,2698,2683,2650,2716,2658,2651,2651,
     8  2651,2651,2651,2649,2651,2661,2678,2668,2676,2651,2651,2652,
     9  2676,2733,2749,2684,2702,2748,2771,2778,2782,2777,2774,2777,
     1  2789,2787,2782,2777,2777,2778,2769,2757,2764,2748,2754,2763,
     2  2756,2763,2762,2762,2771,2755,2770,2778,2764,2207,2694,2708,
     3  2770,2742,2718,2649,2647,2663,2666,2650,2650,2648,2643,2644,
     4  2660,2659,2658,2659,2667,2666,2667,2651,2651,2651,2651,2665,
     5  2666,2652,2652,2697,2743,2777,2769,2731,2755,2759,2768,2789,
     6  2793,2789,2789,2804,2794,2791,2803,2788,2807,2727,2793,2792,
     7  2804,2810,2805,2799,2797,2790,2800,2794,2788,2806,2789,2786,
     8  2812,2789,2795,2798,2816,2806,2778,2731,2641,-900,2718,2703,
     9  2787,2777,2805,2787,2765,2785,2750,2748,2724,2667,2660,2651,
     1  2817,2824,2802,2792,2773,2796,2806,2799,2798,2800,2792,2795,
     2  2791,2798,2809,2798,2811,2810,2821,2815,2817,2814,2812,2810,
     3  2809,2805,2803,2800,2806,2821,2858,2797,2814,2756,2783,2782,
     4  2792,2774,2782,2790,2790,2792,2796,2797,2795,2800,2801,2794,
     5  2808,2801,2779,2802,2796,2722,2696,2692,2700,2330,-900,2687,
     6  2712,2767,2785,2794,2795,2804,2798,2804,2799,2798,2803,2814,
     7  2766,2782,2836,2806,2796,2796,2798,2803,2808,2822,2821,2838,
     8  2847,2851,2849,2845,2820,2767,2769,2785,2815,2871,2853,2824,
     9  2832,2800,2841,2854,2865,2848,2795,2800,2827,2840,2804,2820,
     1  2829,2796,2742,2743,2749,2757,2756,2753,2748,2749,2747,2746,
     2  2750,2751,2757,2753,2758,2748,2753,2756,2669,2701,-900,2654,
     3  2299,2708,2812,2823,2818,2840,2845,2838,2768,2771,2801,2807,
     4  2806,2810,2815,2772,-900,2756,2708,2740,2772,2770,2775,2780,
     5  2788,2790,2791,2793,2805,2807,2821,2821,2820,2809,2771,-900,
     6  2819,2823,2830,-900,-900,-900,2767,2751,2775,2793,2804,2791,
     7  2796,2797,2803,2791,2793,2789,2790,2748,2717,2703,2696,2683,
     8  2679,2679,2678,2680,2692,2693,2700,2717,2738,2768,-900,-900,
     9  -900,2337,2740,2775,2780,2786,2784,2784,2784,2791,2799,2803,
     1  2779,2794,2796,2777,-900,-900,2675,2674,2661,2631,2697,2710,
     2  2718,2720,2734,2740,2744,2756,2763,2768,2764,2758,2732,-900,
     3  -900,-900,-900,-900,-900,-900,2549,2708,2724,2734,2740,2732,
     4  2734,2732,2738,2730,2728,2738,2744,2727,2718,2709,2718,2739,
     5  2732,2709,2730,2741,2758,2755,2711,2709,2717,2741,-900,-900,
     6  -900,-900,2685,2807,2761,2720,2731,2750,2743,2746,2761,2767,
     7  2766,2788,2804,-900,-900,-900,-900,2604,2632,2557,2595,2572,
     8  2600,2645,2661,2672,2671,2642,2663,2668,2692,2646,2628,2588,
     9  -900,-900,-900,-900,-900,2613,2651,2678,2685,2664,2665,2634,
     1  2667,2664,2655,2670,2657,2661,2654,2650,2647,2659,2672,2752,
     2  2770,2765,2730,2721,2738,2755,2767,2720,2693,2709,-900,-900,
     3  -900,-900,2575,2712,2761,2767,2774,2783,2797,2818,2799,2752,
     4  2757,2773,2833,-900,-900,-900,-900,2531,2523,2519,2529,2540,
     5  2539,2539,2541,2545,2544,2542,2559,2560,2544,2531,2511,2508,
     6  2491,-900,-900,2480,2477,2545,2548,2519,2518,2507,2514,2493,
     7  2514,2569,2583,2600,2602,2600,2598,2608,2665,2665,2712,2745,
     8  2760,2717,2696,2714,2729,2745,2756,2770,2717,2690,-900,-900,
     9  -900,-900,-900,-900,2731,2739,2759,2776,2794,2813,2810,2769,
     1  2769,2717,2649,-900,-900,-900,-900,-900,2512,2500,2533,2512,
     2  2502,2510,2501,2505,2496,2501,2493,2493,2491,2482,2477,2474,
     3  2468,2458,2441,2450,2477,2519,2492,2475,2468,2469,2463,2474,
     4  2503,2511,2521,2563,2567,2570,2576,2585,2592,2602,2616,2631,
     5  2644,2664,2676,2690,2705,2720,2731,2736,2699,-900,-900,-900,
     6  -900,-900,-900,-900,2708,2718,2732,2751,2767,2771,2770,2773,
     7  2666,2531,2384,-900,-900,-900,-900,2545,2554,2562,2543,2517,
     8  2500,2480,2482,2473,2476,2474,2471,2460,2412,2299,2364,2382,
     9  2416,2428,2439,2425,2458,2451,2455,2447,2446,2439,2459,2462,
     1  2475,2537,2545,2558,2571,2581,2578,2589,2581,2603,2604,2603,
     2  2608,2629,2606,2610,2621,2652,2631,2668,2698,-900,-900,-900,
     3  -900,-900,-900,-900,-900,2649,2633,2641,2640,2648,2658,2664,
     4  2579,2454,2454,-900,-900,-900,-900,-900,2579,2602,2587,2549,
     5  2540,2494,2475,2458,2458,2455,2454,2446,2195,2286,2247,2309,
     6  2347,2430,2435,2402,2395,2444,2441,2443,2441,2454,2478,2537,
     7  2552,2570,2581,2588,2593,2589,2603,2586,2578,2588,2595,2594,
     8  2602,2579,2574,2606,2601,2606,2603,2512,-900,-900,-900,-900,
     9  -900,-900,1984,2606,2607,2609,2619,2626,2637,2646,2641,2615,
     1  2501,2234,-900,-900,-900,-900,-900,-900,2549,2600,2597,2567,
     2  2533,2505,2482,2472,2462,2457,2421,2295,2206,2336,2269,2388,
     3  2404,2454,2451,2444,2426,2442,2434,2444,2445,2447,2470,2460,
     4  2466,2476,2488,2512,2505,2498,2507,2517,2521,2535,2542,2547,
     5  2546,2548,2552,2528,2491,2462,2409,2403,2252,-900,-900,-900,
     6  -900,2053,2556,2604,2600,2602,2607,2603,2593,2542,2527,2514,
     7  2537,-900,-900,-900,-900,-900,-900,-900,-900,2626,2617,2593,
     8  2563,2529,2488,2443,2394,2388,2361,2250,2238,2355,2369,2360,
     9  2412,2441,2429,2428,2411,2420,2431,2442,2452,2436,2468,2468,
     1  2469,2475,2475,2488,2479,2490,2484,2477,2497,2503,2491,2475,
     2  2449,2425,2408,2418,2399,2402,2372,2280,2221,-900,-900,2111,
     3  2544,2431,2555,2579,2578,2611,2588,2584,2535,2372,-900,-900,
     4  -900,-900,-900,-900,-900,-900,-900,-900,2635,2593,2623,2618,
     5  2620,2640,2499,2412,2355,2359,2305,2193,2099,2391,2382,2371,
     6  2427,2464,2463,2464,2465,2467,2468,2471,2481,2484,2490,2494,
     7  2497,2504,2508,2515,2523,2529,2519,2505,2494,2485,2488,2475,
     8  2421,2405,2405,2400,2405,2386,2422,2594,2596,2541,2610,2518,
     9  2537,2536,2629,2668,2674,2643,2644,2650,2631,-900,-900,-900,
     1  -900,-900,-900,-900,-900,-900,-900,2742,2679,-900,2607,2642,
     2  2666,2673,2584,-900,2226,2265,2216,2057,-900,2399,2447,2395,
     3  2480,2484,2477,2475,2474,2476,2480,2483,2488,2498,2503,2508,
     4  2512,2520,2524,2536,2547,2558,2565,2571,2579,2580,2590,2573,
     5  2557,2540,2512,2448,2484,2585,2582,2594,2590,2594,2579,2563,
     6  2568,2665,2741,2750,2763,2770,2770,2706,2735,-900,-900,-900,
     7  -900,-900,-900,-900,-900,-900,-900,2804,-900,-900,-900,2693,
     8  2727,2673,-900,-900,-900,2070,2008,-900,-900,2374,2455,2498,
     9  2477,2529,2524,2518,2512,2512,2514,2512,2534,2581,2630,2631,
     1  2630,2622,2602,2565,2562,2586,2597,2609,2624,2636,2650,2662,
     2  2653,2616,2550,-900,2665,2695,2612,2618,2713,2686,2664,2658,
     3  2674,2737,2758,2772,2785,2801,2816,2828,2805,-900,-900,-900,
     4  -900,-900,-900,-900,-900,-900,3020,2912,-900,2884,2853,2697,
     5  -900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,
     6  2538,2569,2578,2587,2585,2582,2579,2578,2584,2580,2601,2620,
     7  2640,2677,2665,2670,2696,2712,2722,2671,2668,2682,2599,2611,
     8  2615,2685,-900,-900,2508,2408,2464,2646,2642,2754,2766,2768,
     9  2773,2776,2789,2802,2811,2821,2836,2847,2871,2876,-900,-900,
     1  -900,-900,2899,2885,2918,2973,2942,-900,-900,-900,-900,-900,
     2  -900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,
     3  2481,2592,2529,2550,2627,2632,2638,2646,2654,2646,2661,2652,
     4  2664,2664,2672,2669,2669,2690,2682,2674,2689,2610,2626,2654,
     5  2636,2695,-900,-900,-900,-900,-900,2574,2675,2758,2782,2815,
     6  2821,2826,2819,2830,2837,2845,2848,2866,2883,2892,2856,-900,
     7  2859,2853,2880,2896,2896,2953,2957,2920,-900, 836, 846,-900,
     8  -900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,2259,
     9  2495,2619,2677,2615,2690,2700,2720,2732,2728,2734,2724,2736,
     1  2738,2741,2742,2740,2711,2644,2644,2633,2637,2642,2655,2682,
     2  -900,-900,-900,-900,-900,-900,-900,-900,1795,2608,2745,2744,
     3  2790,2807,2790,2780,2794,2788,2806,2820,2820,2819,2811,2872,
     4  2850,2948,2820,2875,-900,1378,1313,1300,1220, 754, 896,-900,
     5  -900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,
     6  -900,-900,2643,2667,2668,2678,2676,2693,2693,2690,2711,2707,
     7  2708,2698,2708,2699,2700,2693,2687,2670,2675,2590,2587,2604,
     8  -900,-900,-900,-900,-900,-900,-900,-900,-900,2499,2612,2526,
     9  2596,2675,2724,2835,2824,2830,2837,2844,2838,2853,2853,2779,
     1  -900,-900,-900,-900,-900,-900,1196,-900,-900,  83, 516,-900,
     2  -900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,
     3  -900,-900,-900,2679,2621,2641,2678,2655,2679,2697,2680,2688,
     4  2688,2686,2685,2706,2672,2659,2630,2627,2611,2604,2570,2059,
     5  -900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,2400,
     6  2493,2554,2655,2746,2858,2858,2866,2863,2847,2849,2854,2758,
     7  2681,2395, 854,-900,-900,-900,-900,-900,-900,-900,2832,-900,
     8  -900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,
     9  -900,-900,-900,2449,2433,2628,2644,2533,2638,2692,2685,2695,
     1  2695,2686,2634,2638,2637,2644,2640,2630,2621,2523,2144,-900,
     2  -900,-900,-900,-900,-900,-900,-900,1932,1683,-900,-900,-900,
     3  2481,2633,2777,2779,2771,2765,2789,2859,2855,2854,2768,2689,
     4  2758,2551,1730, 527, 460,-900,-900,-900,-900,-900,-900,-900,
     5  -900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,
     6  -900,-900,-900,2503,2582,2618,2614,2590,2565,2664,2676,2685,
     7  2652,2592,2617,2580,2559,2602,2544,2585,2455,2053,-900,-900,
     8  -900,-900,-900,-900,-900,1867,2162,2124,1880,-900,2284,2549,
     9  2690,2767,2743,2751,2756,2758,2767,2848,2851,2854,2787,2779,
     1  2781,2401,-900, 376, 317,-900,-900,-900,-900,-900,-900,-900,
     2  -900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,
     3  -900,-900,-900,-900,-900,-900,-900,2587,2562,-900,2619,2585,
     4  2580,2562,2522,2015,-900,-900,-900,-900,-900,-900,-900,-900,
     5  -900,-900,-900,-900,-900,2232,2514,2351,2437,2557,2451,2644,
     6  2699,2636,2610,2720,2751,2747,2743,2766,2769,2744,2785,2804,
     7  2792,2766,2679,2665,-900,-900,-900,2556,2582,2674,1507,2180,
     8  -900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,
     9  -900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,-900,
     1  2398,2508,2542,2396,-900,-900,-900,-900,1751,-900,-900,-900,
     2  1733,-900,-900,2073,1664,-900,2434,2382,2225,-900,2278,2536,
     3  2632,2624,-900,-900,2609,2728,2728,2744,2735,2751,2752,2749,
     4  2753,2753,2752,2754,2753,2752,2753,2752,2750,2749,2706,2484,
     5  2496,2254,1479,1256,1010,-900,-900,-900,-900,-900,2103,1570,
     6  1648, 900, 952,1343,1577,1234,1408,1401,1556,2316,2341,2393,
     7  2331,2470,2427,2290,2413,2329,2216,2303,1964,2025,2295,2264,
     8  2236,2038,1909,2215,2359,2237,2509,-900,2244,2566,2565,2497,
     9  2617,-900,-900,-900,-900,-900,-900,2161,2655,2719,2746,2749,
     1  2730,2752,2727,2722,2715,2710,2721,2703,2693,2704,2698,2668,
     2  2597,2463,2204,2068,2016,2099,2327,2218,2422,1842,2047,2220,
     3  2025,2192,2036,1946,1961,2283,2330,2182,2109,2515,2441,2397,
     4  2436,2441,2362,2316,2384,2364,2414,2373,-900,2414,2416,2317,
     5  2352,2485,2479,2460,2473,2234,1682,-900,2562,2576,2534,2412,
     6  -900,-900,-900,-900,-900,-900,-900, -15,2401,2617,2632,2709,
     7  2649,2657,2609,2681,2616,2631,2645,2629,2608,2630,2683,2632,
     8  2582,2526,2470,2599,2575,2527,2532,2518,2420,2624,-900,-900,
     9  2417,-900,2469,2520,2571,2521,2412,-900,2622,-900,2519,2417,
     1  2415,2416,2417,2417,2414,2416,2432,2364,2440,2448,2417,2417,
     2  2418,2442,2276,2441,2417,2370,2326,2268,1693, 122,2373,2500,
     3  2526,2528,-900,-900,-900,-900,-900,2520,2471,2496,2522,2539,
     4  2486,2571,2519,2490,2490,2490,2311,2675,2624,2589,2518,2313,
     5  2547,2555,2520,2519,2518,2521,2517,2485,2490,2725,2519,2555,
     6  2626,2494,2468,2519,2470,2443,2494,2570,2519,2380,2418,2518,
     7  2467,2450,2417,2417,2490,2467,2517,2414,2417,2516,2466,2516,
     8  2417,2467,2490,2490,2417,2451,2418,2419,2417,2490,2449,2418,
     9  2490,2490,2519,2468,2490,2417,2490,2469,2468,2451,2493,2520/
      rlo=rlong
      if(rlong.lt.0) rlo=rlong+360
      if(rlong.ge.360) rlo=rlong-360
      x=rlo/5.
      y=(rlat+90.)/5.
      nx=x+1
      ny=y+1
      id=idens(nx,ny)
      no=0
      if(id.lt.-800) then
c
c no data; look at adjacent cells and average as many as found; crude but
c  probably adequate
c
        id=0
        if(ny.gt.1.and.idens(nx,ny-1).gt.-800) then
          id=id+idens(nx,ny-1)
          no=no+1
        endif
        if(ny.lt.36.and.idens(nx,ny+1).gt.-800) then
          id=id+idens(nx,ny+1)
          no=no+1
        endif
        if(nx.gt.1.and.idens(nx-1,ny).gt.-800) then
          id=id+idens(nx-1,ny)
          no=no+1
        endif
        if(nx.lt.72.and.idens(nx+1,ny).gt.-800) then
          id=id+idens(nx+1,ny)
          no=no+1
        endif
        if(no.gt.1) id=id/no
c
c  no nonzero cells found; return a value of zero
c
        if(no.eq.0) id=-100000
      endif
      rho=1000.+id/100.
      return
      end
